<template>
    <nav class="navbar navbar-expand-lg mynav">
        <div class="container">
            <!-- :to="{name:'Home', query:{page:1}}" -->
            <router-link class="navbar-brand" :to="{name:'Home'}">
                <svg t="1711091592185" class="icon r-icon" viewBox="0 0 1162 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11316" width="200" height="200"><path d="M1162 453.2C1162 238.2 901.8 64 581 64S0 238.2 0 453.2C0 644.8 206.6 804 478.8 836.2V960h198.2v-123c48.6-5.4 95.2-14.8 138.8-27.8L896 960h224l-134.8-227.4c109-70.8 176.8-169.8 176.8-279.4z m-933.6 29c0-147 197.8-266 441.6-266s423.8 81.4 423.8 266c0 100.2-53 170-140.6 212.8-4.8-3.2-9.4-5.8-12.8-7.4-20.4-10.4-55.6-21-55.6-21s173.2-12.8 173.2-185.4-181.2-175.8-181.2-175.8h-398V722c-148.2-43-250.4-134.2-250.4-239.8z m450.2 76.6v-111.2c115.6 0 175.6-13.6 175.6 54.6 0 73-76.4 56.6-175.6 56.6z m-1.8 145H730c21.6 0 37.8 23.4 48 38.4-32.2 3.8-66 5.6-101.2 5.8v-44.2z" fill="#2c2c2c" p-id="11317"></path></svg>
                <span style="font-weight: bold;">空间</span>
            </router-link>
            <!-- <a href="/?page="  class="navbar-brand">
                <svg t="1711091592185" class="icon" viewBox="0 0 1162 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11316" width="200" height="200"><path d="M1162 453.2C1162 238.2 901.8 64 581 64S0 238.2 0 453.2C0 644.8 206.6 804 478.8 836.2V960h198.2v-123c48.6-5.4 95.2-14.8 138.8-27.8L896 960h224l-134.8-227.4c109-70.8 176.8-169.8 176.8-279.4z m-933.6 29c0-147 197.8-266 441.6-266s423.8 81.4 423.8 266c0 100.2-53 170-140.6 212.8-4.8-3.2-9.4-5.8-12.8-7.4-20.4-10.4-55.6-21-55.6-21s173.2-12.8 173.2-185.4-181.2-175.8-181.2-175.8h-398V722c-148.2-43-250.4-134.2-250.4-239.8z m450.2 76.6v-111.2c115.6 0 175.6-13.6 175.6 54.6 0 73-76.4 56.6-175.6 56.6z m-1.8 145H730c21.6 0 37.8 23.4 48 38.4-32.2 3.8-66 5.6-101.2 5.8v-44.2z" fill="#2c2c2c" p-id="11317"></path></svg>
                <span style="font-weight: bold; text-align: center;">空间</span>
            </a> -->
            <button 
                class="navbar-toggler" 
                type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#navbarText" 
                aria-controls="navbarText" 
                aria-expanded="false" 
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <!-- , query:{page:1} -->
                    <router-link class="nav-link mynav-link" :to="{name:'Home'}">首页</router-link>  
                    <!-- <a href="/?page=1"  class="nav-link mynav-link">首页</a> -->
                </li>
                <li class="nav-item" v-if="$store.state.user.is_login">
                    <router-link class="nav-link mynav-link" :to="{name:'Share'}">分享</router-link>
                </li>
                <!-- <li class="nav-item">
                <router-link class="nav-link" href="#">Pricing</router-link>
                </li> -->
            </ul>
            
            <!-- 搜索栏目 -->
            <ul class="navbar-nav" style="padding-right: 10px;">
                <li class="nav-item" style="display: flex; justify-content: space-between; align-items: center;">
                    <el-input
                        maxlength="30"
                        v-model="search_key_word"
                        style="width: 270px"
                        placeholder="对什么感兴趣..."
                        :class="{ 'search-box-visible': isSearchBoxVisible }"
                        @keyup.enter="do_search"
                        clearable
                    />
                    <span class="search-button" @click="toggleSearchBox">
                        <svg t="1712489889176" class="icon original-search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1835" width="200" height="200"><path d="M404.210526 0C180.547368 0 0 180.547368 0 404.210526s180.547368 404.210526 404.210526 404.210527c97.010526 0 185.936842-35.031579 256-91.621053 21.557895-16.168421 37.726316-35.031579 56.589474-56.589474 56.589474-70.063158 91.621053-158.989474 91.621053-256 0-223.663158-180.547368-404.210526-404.210527-404.210526z m0 727.578947C226.357895 727.578947 80.842105 582.063158 80.842105 404.210526S226.357895 80.842105 404.210526 80.842105s323.368421 145.515789 323.368421 323.368421-145.515789 323.368421-323.368421 323.368421z" fill="#999999" p-id="1836"></path><path d="M1010.526316 1013.221053c-8.084211 8.084211-18.863158 10.778947-26.947369 10.778947-10.778947 0-21.557895-2.694737-26.947368-10.778947l-293.726316-296.421053c21.557895-16.168421 37.726316-35.031579 56.589474-56.589474l293.726316 296.421053c13.473684 16.168421 13.473684 40.421053-2.694737 56.589474z" fill="#999999" p-id="1837"></path><path d="M716.8 660.210526c-16.168421 21.557895-35.031579 37.726316-56.589474 56.589474l-2.694737-2.694737c-16.168421-16.168421-16.168421-40.421053 0-56.589474 8.084211-8.084211 18.863158-10.778947 26.947369-10.778947 10.778947 0 21.557895 2.694737 32.336842 13.473684z" fill="#999999" p-id="1838"></path></svg>
                        <svg t="1712490364395" class="icon hover-search-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2163" width="200" height="200"><path d="M404.210526 0C180.547368 0 0 180.547368 0 404.210526s180.547368 404.210526 404.210526 404.210527c97.010526 0 185.936842-35.031579 256-91.621053 21.557895-16.168421 37.726316-35.031579 56.589474-56.589474 56.589474-70.063158 91.621053-158.989474 91.621053-256 0-223.663158-180.547368-404.210526-404.210527-404.210526z m0 727.578947C226.357895 727.578947 80.842105 582.063158 80.842105 404.210526S226.357895 80.842105 404.210526 80.842105s323.368421 145.515789 323.368421 323.368421-145.515789 323.368421-323.368421 323.368421z" fill="#2c2c2c" p-id="2164"></path><path d="M1010.526316 1013.221053c-8.084211 8.084211-18.863158 10.778947-26.947369 10.778947-10.778947 0-21.557895-2.694737-26.947368-10.778947l-293.726316-296.421053c21.557895-16.168421 37.726316-35.031579 56.589474-56.589474l293.726316 296.421053c13.473684 16.168421 13.473684 40.421053-2.694737 56.589474z" fill="#2c2c2c" p-id="2165"></path><path d="M716.8 660.210526c-16.168421 21.557895-35.031579 37.726316-56.589474 56.589474l-2.694737-2.694737c-16.168421-16.168421-16.168421-40.421053 0-56.589474 8.084211-8.084211 18.863158-10.778947 26.947369-10.778947 10.778947 0 21.557895 2.694737 32.336842 13.473684z" fill="#2c2c2c" p-id="2166"></path></svg>
                    </span>
                    <!-- :suffix-icon="Search" -->
                </li>
            </ul>

            <!-- 通知栏目 -->
            <ul class="navbar-nav" v-if="$store.state.user.is_login">
                <li class="nav-item">
                    
                    <!-- <router-link v-if="notifications_count > 0" class="nav-link mynav-link" style="padding-right: 16px;" :to="{name:'Notifications'}">
                        <el-badge :value="notifications_count" class="item">
                            <svg  t="1712485122867" class="icon original-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#8A8A8A" p-id="1871"></path></svg>
                            <svg t="1712485122867" class="icon hover-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#2c2c2c" p-id="1871"></path></svg>
                        </el-badge>
                    </router-link>

                    <router-link v-if="notifications_count === 0" class="nav-link mynav-link" style="padding-right: 16px;" :to="{name:'Notifications'}">
                        <svg  t="1712485122867" class="icon original-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#8A8A8A" p-id="1871"></path></svg>
                        <svg t="1712485122867" class="icon hover-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#2c2c2c" p-id="1871"></path></svg>
                    </router-link> -->
                    <router-link v-if="$store.state.user.unread_notification_count > 0 && $store.state.user.unread_notification_count <= 99" class="nav-link mynav-link" style="padding-right: 30px;" :to="{name:'Notifications'}">
                        <el-badge :value="$store.state.user.unread_notification_count" class="item">
                            <svg  t="1712485122867" class="icon original-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#8A8A8A" p-id="1871"></path></svg>
                            <svg t="1712485122867" class="icon hover-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#2c2c2c" p-id="1871"></path></svg>
                        </el-badge>
                    </router-link>

                    <router-link v-if="$store.state.user.unread_notification_count > 99" class="nav-link mynav-link" style="padding-right: 30px;" :to="{name:'Notifications'}">
                        <el-badge :value="'99+'" class="item">
                            <svg  t="1712485122867" class="icon original-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#8A8A8A" p-id="1871"></path></svg>
                            <svg t="1712485122867" class="icon hover-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#2c2c2c" p-id="1871"></path></svg>
                        </el-badge>
                    </router-link>

                    <router-link v-if="$store.state.user.unread_notification_count === 0" class="nav-link mynav-link" style="padding-right: 30px;" :to="{name:'Notifications'}">
                        <svg  t="1712485122867" class="icon original-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#8A8A8A" p-id="1871"></path></svg>
                        <svg t="1712485122867" class="icon hover-icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1870" width="200" height="200"><path d="M512 42.666667c63.637333 0 116.288 50.432 120.682667 114.005333 103.125333 46.058667 175.552 149.12 175.552 269.696v203.306667C867.477333 677.952 896 741.525333 896 820.458667c0 17.557333-15.36 32.896-32.917333 32.896H640l-0.085333 4.8A128 128 0 0 1 384 853.333333L160.917333 853.333333C143.36 853.333333 128 837.973333 128 820.437333c0-76.736 28.522667-142.506667 87.765333-190.741333v-203.306667c0-120.618667 72.426667-223.658667 175.552-269.717333C395.712 93.098667 448.362667 42.666667 512 42.666667z m64 810.688L448 853.333333l0.106667 3.754667A64 64 0 0 0 576 853.354667zM512 106.666667c-29.525333 0-54.741333 23.914667-56.832 54.421333l-2.645333 38.357333-35.114667 15.68c-83.072 37.077333-137.642667 119.104-137.642667 211.242667v233.749333l-23.594666 19.2c-35.136 28.608-55.744 65.173333-62.08 110.016h635.904l-1.066667-7.082666c-7.210667-41.962667-27.2-75.306667-61.098667-102.933334l-23.594666-19.2V426.368c0-92.16-54.570667-174.165333-137.642667-211.242667l-35.114667-15.68-2.645333-38.357333C566.741333 130.581333 541.525333 106.666667 512 106.666667z" fill="#2c2c2c" p-id="1871"></path></svg>
                    </router-link>
                </li>
            </ul>

            <ul class="navbar-nav" v-if="!$store.state.user.is_login">
                <li class="nav-item">
                    <router-link class="nav-link mynav-link" :to="{name:'Login'}">登录/注册</router-link>
                </li>
            </ul>

            <!-- 登录成功后，显示用户头像，以及用户名称 -->
            <ul class="navbar-nav" v-else>
                <!-- <li class="nav-item">
                    <router-link class="nav-link" :to="{name:'Login'}">退出</router-link>
                </li> -->
                <div class="nav-item dropdown">
                    <a class="nav-item dropdown-toggle mynav-link" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <img class="img-fluid avatar" :src="$store.state.user.avatar" alt="">
                        {{$store.state.user.username}}
                        <!-- <div class="mynav-link">{{$store.state.user.username}}</div> -->
                    </a>

                    <ul class="dropdown-menu">
                        <li>
                            <router-link class="my-dropdown-item dropdown-item " :to="{name:'Profile', params:{userid:$store.state.user.id}}">
                                <svg t="1713430556012" class="icon mysvg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3045" width="200" height="200"><path d="M509.3 511.3c-117.1 0-212.4-95.3-212.4-212.4S392.2 86.5 509.3 86.5c117.1 0 212.4 95.3 212.4 212.4s-95.3 212.4-212.4 212.4z m0-374.8c-89.5 0-162.4 72.9-162.4 162.4s72.9 162.4 162.4 162.4 162.4-72.9 162.4-162.4-72.9-162.4-162.4-162.4z" p-id="3046" fill="#2c2c2c"></path><path d="M812.5 903.5H219.1c-29.3 0-56.7-13.1-75.1-35.9-18.4-22.8-25.4-52.4-19.1-81.1 19.6-90.5 68.9-172.6 138.7-231.4 34.9-29.4 74-52.3 116.1-68.1 43.6-16.4 89.4-24.6 136.2-24.6s92.6 8.3 136.2 24.6c42.1 15.8 81.1 38.7 116 68.1 69.8 58.7 119 140.9 138.7 231.4 6.2 28.7-0.7 58.3-19.1 81.1-18.5 22.8-45.9 35.9-75.2 35.9zM515.8 512.4c-40.8 0-80.7 7.2-118.6 21.5-36.8 13.8-70.9 33.8-101.4 59.5-61.4 51.7-104.7 124-122 203.7-3 13.9 0.3 28.1 9.2 39.1 8.9 11 22 17.3 36.2 17.3h593.4c14.1 0 27.3-6.3 36.2-17.3 8.9-11 12.2-25.3 9.2-39.1-17.3-79.7-60.7-152.1-122-203.7-30.5-25.7-64.7-45.7-101.4-59.5-38.1-14.3-78.1-21.5-118.8-21.5z" p-id="3047" fill="#2c2c2c"></path></svg>
                                <span style="padding-left: 5px;">个人中心</span>
                            </router-link>
                        </li>
                        <!-- <li><div class="dropdown-item" @click="enterProfile($store.state.user.id)">个人中心</div></li> -->

                        <li>
                            <router-link class="my-dropdown-item dropdown-item " :to="{name:'ProfileStar', params:{userid:$store.state.user.id}}">
                                <svg t="1713429999788" class="icon mysvg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1678" width="200" height="200"><path d="M758.272 921.088c-5.12 0-10.24-1.024-14.848-3.584L512 796.16l-231.424 121.344c-10.752 5.632-23.552 4.608-33.28-2.56s-14.336-18.944-12.288-30.72l44.032-257.024-187.392-182.272c-8.704-8.192-11.776-20.992-8.192-32.256 3.584-11.776 13.312-19.968 25.6-21.504l259.072-37.376 115.712-233.984c5.12-10.752 16.384-17.408 28.16-17.408 12.288 0 23.04 6.656 28.16 17.408l115.712 233.984 259.072 37.376c11.776 1.536 22.016 9.728 25.6 21.504 3.584 11.264 0.512 24.064-8.192 32.256l-187.392 182.272 44.032 257.024c2.048 11.776-2.56 23.552-12.288 30.72-5.12 4.096-11.776 6.144-18.432 6.144z m-624.64-492.032l177.152 172.032c7.68 7.168 10.752 17.92 9.216 28.16l-41.984 243.2L497.152 757.76c9.216-4.608 19.968-4.608 29.184 0l219.136 114.688-41.984-243.2c-1.536-10.24 1.536-20.48 9.216-28.16l177.664-172.032-245.248-35.84c-10.24-1.536-18.944-7.68-23.552-17.408L512 154.624 402.432 376.32c-4.608 9.216-13.312 15.36-23.552 16.896l-245.248 35.84z" p-id="1679" fill="#2c2c2c"></path></svg>
                                <span style="padding-left: 5px;">我的收藏</span>
                            </router-link>
                        </li>
                        
                        <!-- 账号安全以及密码修改等功能 -->
                        <li>
                            <router-link class="my-dropdown-item dropdown-item " :to="{name:'Profile', params:{userid:$store.state.user.id}}">
                                <svg t="1713431175227" class="icon mysvg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6844" width="200" height="200"><path d="M925.696 596.48c-3.584 24.064-18.432 40.448-36.864 40.448h-3.584c-60.928 0-110.592 49.664-110.592 112.128 0 20.48 9.216 42.496 9.216 42.496 9.216 22.016 2.048 47.616-16.384 60.928h-2.048l-106.496 60.928h-2.048c-5.632 2.048-12.8 3.584-20.48 3.584-14.848 0-31.232-7.168-40.448-16.384-12.8-14.848-55.296-53.248-88.064-53.248S432.64 885.76 419.84 899.072c-9.216 11.264-24.064 16.384-40.448 16.384-7.168 0-14.848-2.048-20.48-3.584h-2.048l-102.912-58.88h-2.048c-18.432-12.8-25.6-40.448-16.384-60.928 0 0 9.216-22.016 9.216-42.496 0-60.928-49.664-112.128-110.592-112.128-16.384 0-31.232-14.848-36.864-40.448 0-2.048-9.216-47.616-9.216-84.48 0-36.864 9.216-82.944 9.216-84.48 3.584-24.064 18.432-40.448 36.864-40.448h3.584c60.928 0 110.592-49.664 110.592-112.128 0-20.48-9.216-42.496-9.216-42.496-11.264-18.432-3.584-46.08 16.384-58.88h2.048L368.64 113.152h2.048c3.584-3.584 9.216-5.632 16.384-5.632 14.848 0 29.184 5.632 40.448 16.384 12.8 12.8 53.248 49.664 86.528 49.664 33.28 0 73.728-34.816 86.528-47.616 9.216-11.264 24.064-16.384 38.4-16.384 7.168 0 14.848 2.048 20.48 3.584h2.048L768 172.032h2.048c18.432 12.8 25.6 40.448 16.384 60.928 0 0-9.216 22.016-9.216 42.496 0 60.928 49.664 112.128 110.592 112.128h3.584c16.384 0 31.232 14.848 36.864 40.448 0 2.048 9.216 47.616 9.216 84.48-2.56 36.352-11.776 82.432-11.776 83.968zM890.88 434.688c-2.048-5.632-2.048-7.168-3.584-9.216-80.896 0-146.944-66.048-146.944-148.992 0-25.6 9.216-51.712 12.8-56.832 2.048-5.632 0-12.8-3.584-16.384l-102.912-56.832h-5.632c-5.632 0-11.264 2.048-12.8 5.632-5.632 5.632-58.88 60.928-114.176 60.928s-108.544-55.808-114.176-61.44c-2.048-5.632-7.168-7.168-12.8-7.168h-5.632L274.944 203.264c-3.584 3.584-5.632 11.264-3.584 16.384 0 0 12.8 29.184 12.8 56.832 0 80.896-66.048 148.992-146.944 148.992-2.048 2.048-2.048 5.632-3.584 9.216 0 0-7.168 44.032-7.168 77.312s7.168 77.312 7.168 77.312c2.048 5.632 2.048 7.168 3.584 9.216 80.896 0 146.944 66.048 146.944 148.992 0 24.064-9.216 47.616-12.8 56.832-2.048 5.632 0 12.8 3.584 16.384l101.376 56.832h5.632c5.632 0 11.264-2.048 12.8-5.632 2.048-2.048 58.88-64.512 115.712-64.512s110.592 58.88 115.712 64.512c2.048 2.048 7.168 5.632 12.8 5.632h5.632l104.96-58.88c3.584-3.584 5.632-11.264 3.584-16.384-2.048-3.584-12.8-29.184-12.8-56.832 0-80.896 66.048-148.992 146.944-148.992 2.048-2.048 2.048-5.632 3.584-9.216 0 0 7.168-44.032 7.168-77.312 0.512-31.232-7.168-75.264-7.168-75.264z m-378.88 224.256c-80.896 0-146.944-66.048-146.944-146.944S431.104 365.056 512 365.056s146.944 66.048 146.944 146.944-66.048 146.944-146.944 146.944z m0-259.072c-60.928 0-112.128 49.664-112.128 112.128s49.664 112.128 112.128 112.128 112.128-49.664 112.128-112.128-51.2-112.128-112.128-112.128z" fill="#2c2c2c" p-id="6845"></path></svg>
                                <!-- <svg t="1713431241289" class="icon mysvg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8749" width="200" height="200"><path d="M759.466667 881.379556v-45.511112h202.979555a15.815111 15.815111 0 0 0 15.758222-15.928888V175.559111a15.815111 15.815111 0 0 0-15.758222-15.928889H488.846222v-45.511111h473.6c33.564444 0 60.984889 27.534222 60.984889 61.44v644.380445c0 33.792-27.420444 61.44-60.984889 61.44h-202.922666z m-156.444445-6.144v-2.275556c0-153.486222-124.131556-278.186667-276.650666-278.186667-152.462222 0-276.593778 124.700444-276.593778 278.186667v2.275556H0.568889v-2.275556a327.338667 327.338667 0 0 1 237.681778-315.221333 229.205333 229.205333 0 0 1-138.24-209.464889c0-125.610667 101.489778-227.783111 226.417777-227.783111 124.814222 0 226.304 102.172444 226.304 227.783111 0 90.737778-55.182222 174.08-138.24 209.464889a327.168 327.168 0 0 1 237.681778 315.050666v2.275556H603.022222v0.170667zM326.314667 169.927111c-97.621333 0-177.038222 79.928889-177.038223 178.232889 0 98.247111 79.416889 178.176 177.038223 178.176 97.621333 0 177.038222-79.928889 177.038222-178.176 0-98.304-79.303111-178.232889-177.038222-178.232889z m341.447111 430.535111v-51.256889h238.136889v51.2H667.875556z m-83.456-154.851555v-51.143111h321.706666v51.2h-321.706666z m0-145.294223v-51.2h321.706666v51.2h-321.706666z" fill="#2c2c2c" p-id="8750"></path></svg> -->
                                <span style="padding-left: 5px;">账号设置</span>
                            </router-link>
                        </li>

                        <li><hr class="dropdown-divider"></li>
                        <li>
                            <router-link class="my-dropdown-item dropdown-item " :to="{name:'Login'}" @click="logout">
                                <!-- <svg t="1713430791146" class="icon mysvg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5567" width="200" height="200"><path d="M384 128H128v768h256v-64H192V192h192v-64z" p-id="5568" fill="#2c2c2c"></path><path d="M640 224l-64 64 192 192H352v64h416L576 736l64 64 256-288-256-288z" p-id="5569" fill="#2c2c2c"></path></svg> -->
                                <svg t="1713430848986" class="icon mysvg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5778" width="200" height="200"><path d="M184.552727 768l0-512c0-38.539636 31.278545-69.818182 69.818182-69.818182l302.545455 0L556.916364 139.636364l-325.818182 0c-51.432727 0-93.090909 41.658182-93.090909 93.090909l0 558.545455c0 51.432727 41.658182 93.090909 93.090909 93.090909l325.818182 0 0-46.545455-302.545455 0C215.784727 837.818182 184.552727 806.539636 184.552727 768zM924.113455 495.522909l-164.584727-164.584727c-9.076364-9.076364-23.831273-9.076364-32.907636 0-9.076364 9.076364-9.076364 23.831273 0 32.907636l124.834909 124.834909L394.007273 488.680727c-12.846545 0-23.272727 10.426182-23.272727 23.272727s10.426182 23.272727 23.272727 23.272727l457.448727 0-124.834909 124.834909c-9.076364 9.076364-9.076364 23.831273 0 32.907636 9.076364 9.076364 23.831273 9.076364 32.907636 0l164.584727-164.584727C933.189818 519.354182 933.189818 504.645818 924.113455 495.522909z" fill="#2c2c2c" p-id="5779"></path></svg>
                                <span style="padding-left: 5px;">退出</span>
                            </router-link>
                        </li>
                    </ul>
                </div>
            </ul>

            </div>
        </div>
    </nav>
</template>


<script>

import { useStore } from 'vuex'
// import router from '@/router/index';   //@定位src目录
import { ElMessage } from 'element-plus';
import {ref} from 'vue'
import {BackendRootURL,} from '../common_resources/resource';
import $ from 'jquery'
import { CheckIsLogin, RefreshToken } from '../utils/MakeAuthenticatedRequest';
export default{
    name:"Navbar",
    setup(){
        const store = useStore()
        const logout = ()=>{
            store.commit('logout');//调用user.js全局里面mutations里面的函数用commit
            store.commit('logout_page')
        }

        
        //搜索关键词
        const search_key_word = ref('')
        const isSearchBoxVisible = ref(true)
        const toggleSearchBox = ()=>{
            isSearchBoxVisible.value = !isSearchBoxVisible.value
            // console.log(isSearchBoxVisible.value)
        }


        //搜索键入成功后，用新窗口打开（待完成）
        const do_search = ()=>{
            if(search_key_word.value === '' || /^\s*$/.test(search_key_word.value)) {
                ElMessage.warning("搜索内容不能为空")
                return 
            }

            //     '1':'日常',  daily
            //     '2':'新鲜事', news
            //     '3':'笔记',   note
            //     '4':'其它'    other
            //          用户     user         

            // console.log(search_key_word.value)  ?
            window.open(`/search/?query_type=news&query_content=${search_key_word.value}`, '_blank');  //新窗口打开
        }
        // const enterProfile = (user_id)=> {
        //     router.push({
        //         name:"Profile",
        //         params:{
        //             userid:user_id,
        //         }
        //     })
        // }
        

        
        

        //通知消息数量(刷新一次获取一次，然后点击一次之前未查看消息，就减一)
        // 获取未读取的信息数
        const getUnreadNotificationsCount = ()=>{
            $.ajax({
                url: BackendRootURL + "/notification/getunreadnotificationcount/",
                type:"GET",
                headers: {
                    'Authorization': "Bearer " + store.state.user.jwt,
                },
                success(resp){
                    if(resp.status === 401) {
                        RefreshToken(store)
                        .then((jwt) => {
                            if(jwt) {
                                getUnreadNotificationsCount(); // 在RefreshToken完成后再调用getUnreadNotificationsCount
                            }
                        })
                        .catch((error) => {
                            console.error(error);
                        });
                    }
                    // notifications_count.value = resp.data
                    store.commit("updateUnreadNotificationCount", resp.data)
                }
            })
        }

        // 未登录不能获取未读通知数量
        (async () => {
            if (await CheckIsLogin(store) === false) {
                return;
            }
            getUnreadNotificationsCount()
        })();

        return {
            search_key_word,
            // notifications_count,
            isSearchBoxVisible,
            toggleSearchBox,
            do_search,
            logout, 
            // enterProfile,
        }
    }
}


</script>


<style scoped>


.avatar{
    width: 30px; 
    height: 30px; 
    border-radius: 50%;
}

a{
    text-decoration: none; /* 取消下划线 */
    color: black; /* 修改字体颜色，这里以红色为例 */
}

.mynav{
    background-color: white;
    /* background-color: #F7F7F7; */
    position: fixed;
    top: 0;
    width: 100vw;
    z-index: 1000;
}

.r-icon {
    max-width: 30px;
    max-height: 30px;
}

.mynav-link{
    color: rgb(107, 107, 107);
}

.mynav-link:hover{
    color: black;
}

.original-search-icon {
    display: block;
    /* margin-top: 3px; */
    max-width: 25px;
    max-height: 25px;
}

.hover-search-icon {
    display: none;
    /* margin-top: 3px; */
    max-width: 25px;
    max-height: 25px;
}

.search-button:hover .original-search-icon {
    display: none;
}

.search-button:hover .hover-search-icon {
    display: block;
}

.original-icon {
    display: block;
    max-width: 25px;
    max-height: 25px;
}

.hover-icon {
    display: none;
    max-width: 25px;
    max-height: 25px;
}

.mynav-link:hover .original-icon {
    display: none;
}

.mynav-link:hover .hover-icon {
    display: block;
}


.mysvg{
    max-height: 25px;
    max-width: 25px;
}

.search-button{
    cursor: pointer;
    max-width: 25px;
    max-height: 25px;
}

.search-box-visible {
    position: absolute;
    right: 0;
    transform: translateX(100%);
    overflow: hidden;
    max-width: 0;
}

.search-box-visible.show {
    transform: translateX(-100%);
    max-width: 270px;
}

.my-dropdown-item{
    display: flex; 
    align-items: center;
}

</style>